/*!
 * palettify v1.0.3 
 * (c) 2018 Dobromir Hristov
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@mariotacke/color-thief")):"function"==typeof define&&define.amd?define(["@mariotacke/color-thief"],e):t.palettify=e(t.colorThief)}(this,function(t){"use strict";function e(t){switch(typeof t){case"string":case"number":case"boolean":return t;case"object":try{return null===t?"":JSON.stringify(t)}catch(t){return"{...}"}default:return""}}function n(t,e,r){if(void 0===r&&(r=0),"object"!=typeof t||null===t||void 0===t)return"";var o=e[r],a=t[o];return r===e.length-1?a:n(a,e,++r)}function r(t,e){return n(e,t.split("."))}function o(t,n,o){return void 0===n&&(n={}),void 0===o&&(o=r),"string"!=typeof t?t:t.replace(d,function(t,a){try{return e(o(a,n))}catch(t){return e(r(a,n))}})}function a(t){return!!t&&"object"==typeof t}function i(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||l(t)}function l(t){return t.$$typeof===E}function s(t){return Array.isArray(t)?[]:{}}function c(t,e){return e&&!0===e.clone&&h(t)?p(s(t),t,e):t}function u(t,e,n){var r=t.slice();return e.forEach(function(e,o){void 0===r[o]?r[o]=c(e,n):h(e)?r[o]=p(t[o],e,n):-1===t.indexOf(e)&&r.push(c(e,n))}),r}function f(t,e,n){var r={};return h(t)&&Object.keys(t).forEach(function(e){r[e]=c(t[e],n)}),Object.keys(e).forEach(function(o){h(e[o])&&t[o]?r[o]=p(t[o],e[o],n):r[o]=c(e[o],n)}),r}function p(t,e,n){var r=Array.isArray(e),o=Array.isArray(t),a=n||{arrayMerge:u};if(r===o)return r?(a.arrayMerge||u)(t,e,n):f(t,e,n);return c(e,n)}function y(){function e(e,n){var r=y(e);return new Promise(function(e){p(r)?e((new t).getPalette(r,n)):r.onload=function(){e((new t).getPalette(r,n))}})}function n(t,e){return t.map(function(t,n){var o=1;return Array.isArray(e)&&e[n]&&(o=e[n]),r(t,o)})}function r(t,e){return"rgba("+t[0]+", "+t[1]+", "+t[2]+", "+e+")"}function o(t){var e=t.target,n=t.styles,r=t.palette,o=t.staticCallback;void 0===o&&(o=null);var a=t.obj;for(var i in n)n.hasOwnProperty(i)&&(e.style[i]=g(n[i],r));o&&o.call(e,a,E.options)}function a(t,e,n,r){for(var o in e)e.hasOwnProperty(o)&&!n.hasOwnProperty(o)?t.style[o]="":n.hasOwnProperty(o)&&(t.style[o]=g(n[o],r))}function i(t){E.options=m(b,t,{clone:!0,arrayMerge:d}),Object.keys(E.options).forEach(function(t){if(E.options[t]instanceof Error)throw E.options[t]})}function l(t){return(299*t[0]+587*t[1]+114*t[2])/1e3}function s(t){return l(t)<170}function c(t,e){return t.map(function(t){return s(t)?e.light:e.dark})}function u(t){var e=document.createElement("a");return e.href=t,e}function f(t){return document.location.host!==u(t).host}function p(t){return!!t.complete&&(void 0===t.naturalWidth||0!==t.naturalWidth)}function y(t){var e=t,n="IMG"!==e.tagName,r=n?t.style.backgroundImage.replace("url(","").replace(")","").replace(/"/gi,""):t.src,o=f(r);if(!e)throw Error("Target is not an element",e);if(n||o&&!e.crossOrigin){if(n&&!e.style.backgroundImage)throw Error("Tag provided is not an image and does not have a background-image style attached to it.");e=new Image(t.naturalWidth,t.naturalHeight),o&&(e.crossOrigin="anonymous"),e.src=r}return e}function d(t,e,n){return e}var v=!1,h=null,b={selector:Error("Please provide \u0430 selector in your options."),eventTarget:Error("Please provide an eventTarget as a parent for your image in the options."),image:Error("Please provide an image to sample."),styleTarget:null,contrastColors:{light:"#fff",dark:"#000"},activeClass:"palettify--active",readyClass:"palettify--ready",colorsToExtract:3,enterEvent:"mouseenter",leaveEvent:"mouseleave",styles:{opacities:[.5,.5,.5],static:{},dynamic:{}},staticCallback:null,beforeEnterCallback:null,afterEnterCallback:null,beforeLeaveCallback:null,afterLeaveCallback:null,onReadyCallback:null},E={options:{},data:[],collectElements:function(){var t="";if(!(h="string"==typeof E.options.selector?document.querySelector(E.options.selector):E.options.selector))throw new Error("Selector "+E.options.selector+" does not exist");t=h.querySelectorAll(E.options.eventTarget),[].slice.call(t,0).forEach(function(t){var e=t.querySelector(E.options.image),n=!0===E.options.styleTarget?t:t.querySelector(E.options.styleTarget||E.options.image),r={eventTarget:t,styleTarget:n,image:e,palette:{original:[],rgb:[],rgba:[]}};E.data.push(r)})},extractColorsAndAttachStyles:function(t){void 0===t&&(t=!1);var r=[];E.data.forEach(function(t,a){r[a]=e(t.image,E.options.colorsToExtract).then(function(e){t.palette.original=e,t.palette.rgb=n(t.palette.original,[]),t.palette.rgba=n(t.palette.original,E.options.styles.opacities),t.palette.contrastColors=c(t.palette.original,E.options.contrastColors),o({target:t.styleTarget,styles:E.options.styles.static,palette:t.palette,staticCallback:E.options.staticCallback,obj:t})})}),t||Promise.all(r).then(function(t){h.classList.add(E.options.readyClass),"function"==typeof E.options.onReadyCallback&&E.options.onReadyCallback.call(E,E)})},generateEnterHandler:function(t){return function(e){t.styleTarget&&("function"==typeof E.options.beforeEnterCallback&&E.options.beforeEnterCallback.call(t.styleTarget,t,E.options,e),t.styleTarget.classList.add(E.options.activeClass),o({target:t.styleTarget,styles:E.options.styles.dynamic,palette:t.palette,obj:t}),"function"==typeof E.options.afterEnterCallback&&E.options.afterEnterCallback.call(t.styleTarget,t,E.options,e))}},generateLeaveHandler:function(t){return function(e){var n=t.styleTarget;n&&("function"==typeof E.options.beforeLeaveCallback&&E.options.beforeLeaveCallback.call(t.styleTarget,t,E.options,e),n.classList.remove(E.options.activeClass),a(t.styleTarget,E.options.styles.dynamic,E.options.styles.static,t.palette),"function"==typeof E.options.afterLeaveCallback&&E.options.afterLeaveCallback.call(t.styleTarget,t,E.options,e))}},attachEventListeners:function(){var t=E.options,e=t.enterEvent,n=t.leaveEvent;e=Array.isArray(e)?e:[e],n=Array.isArray(n)?n:[n],E.data.forEach(function(t){t.enterHandler=E.generateEnterHandler(t),t.leaveHandler=E.generateLeaveHandler(t),e.forEach(function(e){t.eventTarget.addEventListener(e,t.enterHandler,!1)}),n.forEach(function(e){t.eventTarget.addEventListener(e,t.leaveHandler,!1)})})},detachEventListeners:function(){var t=E.options,e=t.enterEvent,n=t.leaveEvent;e=Array.isArray(e)?e:[e],n=Array.isArray(n)?n:[n],E.data.forEach(function(t){e.forEach(function(e){t.eventTarget.removeEventListener(e,t.enterHandler,!1)}),n.forEach(function(e){t.eventTarget.removeEventListener(e,t.leaveHandler,!1)})})},init:function(t){if(v)throw new Error("Palettify is already initialized");return i(t),E.collectElements(),E.extractColorsAndAttachStyles(),E.attachEventListeners(),v=!0,E},destroy:function(t){void 0===t&&(t=!0),E.detachEventListeners(),t&&E.cleanUp(),E.data=[],v=!1},reInit:function(){E.destroy(),E.init(E.options)},cleanUp:function(){E.data.forEach(function(t){for(var e in E.options.styles.static)E.options.styles.static.hasOwnProperty(e)&&(t.styleTarget.style[e]="")})},setOptions:function(t,e){void 0===e&&(e=!0),E.options=Object.assign({},E.options,t),e&&E.reInit()},isInitialized:function(){return v}};return E}t="default"in t?t.default:t;var d=/\{\{\s*(.*?)\s*\}\}/g,v=o,g=v,h=function(t){return a(t)&&!i(t)},b="function"==typeof Symbol&&Symbol.for,E=b?Symbol.for("react.element"):60103;p.all=function(t,e){if(!Array.isArray(t)||t.length<2)throw new Error("first argument should be an array with at least two elements");return t.reduce(function(t,n){return p(t,n,e)})};var m=p;return y});